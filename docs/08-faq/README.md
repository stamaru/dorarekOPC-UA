# よくある質問 (FAQ)

このドキュメントでは、dorarekOPC-UAプロジェクトに関するよくある質問とその回答をまとめています。

## 一般的な質問

### Q: dorarekOPC-UAとは何ですか？
A: dorarekOPC-UAは、OPC-UA（Open Platform Communications Unified Architecture）を活用した工場設備監視・分析システムです。工場設備が停止した際に、OPC-UAプロトコルを介して停止信号を検知し、その前後の映像を自動的に記録・クラウドへアップロードして、AI分析により原因究明を支援するシステムです。

### Q: このプロジェクトの主な目的は何ですか？
A: 工場における設備停止インシデント発生時の状況を映像として記録・分析することで、原因究明の迅速化、再発防止策の策定支援、および運用監視の高度化を実現することが主な目的です。

### Q: このシステムはどのような問題を解決しますか？
A: 工場設備の停止時に何が起きたのかを正確に把握することは、従来は困難でした。オペレーターが常に監視しているとは限らず、停止後に原因を調査する際に状況証拠が不足することがあります。このシステムは自動的に設備停止前後の映像を記録・分類することで、この問題を解決します。

## 技術的な質問

### Q: システムはどのようなアーキテクチャで構成されていますか？
A: システムは主に3つの層で構成されています：
1. 工場設備層（OPC-UAサーバーを搭載した設備）
2. エッジ層（カメラ、エッジゲートウェイ、OPC-UAクライアント、映像処理機能）
3. クラウド層（オブジェクトストレージ、映像AI分析サービス、管理インターフェース）

### Q: どのようにして設備の停止を検知していますか？
A: 「OPC UA for Machinery」のMachineryItemState情報モデルを使用し、特にOutOfService状態への遷移を監視します。エッジゲートウェイのOPC-UAクライアントが設備のOPC-UAサーバーをサブスクライブし、この状態変化を検出します。

### Q: 映像はどのように処理されますか？
A: エッジゲートウェイで、IPカメラからの映像を常時循環バッファに記録しています。設備停止信号を検知すると、停止時刻の前後指定秒数（設定可能）の映像を切り出し、クラウドへアップロードします。

### Q: AIによる映像分析はどのように行われますか？
A: クラウド上のAIサービス（Amazon Rekognition、Azure Video Indexer、Google Cloud Video Intelligence等）を使用して、アップロードされた映像を分析します。カスタム学習モデルを用いて、工場特有の状況（特定の故障パターンなど）を自動的に分類します。

## 実装と設定に関する質問

### Q: このシステムを導入するための前提条件は何ですか？
A: 以下が主な前提条件です：
- OPC-UAサーバーを搭載した工場設備（または既存の設備にOPC-UAアダプターを追加）
- エッジコンピューティング能力を持つゲートウェイデバイス
- 設備周辺を撮影するIPカメラ
- クラウドサービスへの接続（インターネットアクセス）

### Q: 必要なハードウェア要件は何ですか？
A: 
- エッジゲートウェイ: 映像処理が可能な性能を持つ産業用PC、NVIDIAのJetsonシリーズ、または同等品
- カメラ: H.265対応IPカメラ（解像度と画角は監視対象に応じて選択）
- ネットワーク: 工場内LANおよびインターネット接続
- ストレージ: ローカル循環バッファとイベントクリップ用のSSDまたはHDD

### Q: サポートされているカメラの種類は何ですか？
A: 基本的にはRTSP/RTMPプロトコルをサポートするネットワークカメラ（IPカメラ）であれば対応可能です。H.265エンコーディングをサポートするカメラが推奨されます。産業環境に設置する場合は、耐環境性（IP67等）を考慮した選定が必要です。

### Q: エッジゲートウェイの設定方法は？
A: エッジコンソールアプリケーションをインストールし、以下の設定を行います：
- OPC-UAサーバー接続情報（エンドポイント、監視ノード等）
- カメラ接続情報（IPアドレス、認証情報等）
- 映像バッファリング設定（解像度、フレームレート、事前/事後記録時間等）
- クラウド接続情報（認証情報、アップロード設定等）

## 運用に関する質問

### Q: システムの信頼性はどのように確保されていますか？
A: 以下の対策により信頼性を確保しています：
- エッジデバイスへのUPS設置による電源障害対策
- ネットワーク障害時のローカルキューイングと接続回復後の自動アップロード
- ストレージ管理とイベントクリップ用の保護されたストレージ領域
- 各コンポーネントの状態監視と自動復旧メカニズム

### Q: データのセキュリティはどのように確保されていますか？
A: 以下のセキュリティ対策を実装しています：
- OPC-UA通信における認証と暗号化
- エッジデバイスのOS堅牢化とファイルシステム暗号化
- クラウドへの転送時のTLS/SSL暗号化
- クラウドストレージでの保存データ暗号化
- 厳格なアクセス制御と認証メカニズム

### Q: 記録された映像はどのくらいの期間保存されますか？
A: 基本的な設計ではクラウド上に以下のようなライフサイクルポリシーを実装しています：
- 標準ストレージ（ホットティア）: 30日間
- 低頻度アクセスティア: 90日間
- 長期アーカイブティア: 1年間
これらは組織のポリシーやコンプライアンス要件に応じてカスタマイズ可能です。

## トラブルシューティング

### Q: OPC-UAサーバーに接続できない場合はどうすればよいですか？
A: 以下を確認してください：
- ネットワーク接続（ファイアウォール設定、ポート開放）
- OPC-UAサーバーのエンドポイント情報
- 認証情報と証明書の設定
- サーバーの可用性とヘルスステータス

### Q: ビデオ記録が行われない場合はどうすればよいですか？
A: 以下を確認してください：
- カメラの接続状態とネットワーク設定
- ストリーミングプロトコルとURLの正確性
- エッジゲートウェイのリソース使用状況（CPU、メモリ、ディスク）
- GStreamerパイプラインの設定とログ

### Q: クラウドへの映像アップロードが失敗する場合はどうすればよいですか？
A: 以下を確認してください：
- インターネット接続の状態
- クラウド認証情報の有効性
- ストレージ容量の制限
- エッジデバイスのログファイルでエラーメッセージを確認

## その他の質問

### Q: このシステムをカスタマイズすることはできますか？
A: はい、システムは高度にカスタマイズ可能です。例えば：
- 監視対象のOPC-UAノードの追加/変更
- 映像処理パラメータの調整
- AIモデルのカスタムトレーニング
- レポートやダッシュボードのカスタマイズ
- 他のシステム（MES、ERPなど）との統合

### Q: システムの拡張性はどうですか？
A: 以下のような拡張が想定されています：
- 複数カメラ/複数設備の監視
- エッジでのAI予備判定による選択的アップロード
- 追加センサーデータ（振動、温度など）との統合
- リアルタイムアラート機能の追加
- 予知保全システムとの連携

### Q: オープンソースですか？商用利用できますか？
A: ライセンス情報についてはプロジェクトのルートディレクトリにあるLICENSEファイルを参照してください。